<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting Started with peppwR • peppwR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started with peppwR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">peppwR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/find-fits.html">Distribution Fitting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>In-depth Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/power-analysis-workflow.html">Power Analysis Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/benchmarking.html">Benchmarking</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/danmaclean/peppwR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting Started with peppwR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/danmaclean/peppwR/blob/master/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>peppwR helps researchers answer power analysis questions for
phosphoproteomics experiments:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Sample size</strong>: “What sample size do I need for 80%
power to detect a 2-fold change?”</li>
<li>
<strong>Power</strong>: “With N=6 per group, what’s my power to
detect a 2-fold change?”</li>
<li>
<strong>Effect size</strong>: “With N=6 and 80% power, what’s the
minimum detectable effect?”</li>
</ol>
<p>This vignette demonstrates a minimal workflow to get you from zero to
power estimates.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># From GitHub</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"danmaclean/peppwR"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://danmaclean.github.io/peppwR/">peppwR</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="generate-synthetic-pilot-data">Generate Synthetic Pilot Data<a class="anchor" aria-label="anchor" href="#generate-synthetic-pilot-data"></a>
</h2>
<p>Let’s create realistic phosphopeptide abundance data: 100 peptides, 2
conditions (control/treatment), 4 replicates each. We’ll use gamma
distributions typical of proteomics data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate peptide-level parameters</span></span>
<span><span class="va">n_peptides</span> <span class="op">&lt;-</span> <span class="fl">100</span></span>
<span><span class="va">n_per_group</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span></span>
<span><span class="va">peptide_params</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  peptide_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pep_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%04d"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">n_peptides</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="co"># Shape parameter: 1.5-5 (lower = more skewed)</span></span>
<span>  shape <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_peptides</span>, <span class="fl">1.5</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  <span class="co"># Rate parameter: scaled to give realistic abundances</span></span>
<span>  rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_peptides</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate observations for each peptide</span></span>
<span><span class="va">pilot_data</span> <span class="op">&lt;-</span> <span class="va">peptide_params</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>      condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"treatment"</span><span class="op">)</span>, each <span class="op">=</span> <span class="va">n_per_group</span><span class="op">)</span>,</span>
<span>      replicate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_per_group</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>      abundance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">n_per_group</span> <span class="op">*</span> <span class="fl">2</span>, shape <span class="op">=</span> <span class="va">shape</span>, rate <span class="op">=</span> <span class="va">rate</span><span class="op">)</span></span>
<span>    <span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">peptide_id</span>, <span class="va">data</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Preview the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">pilot_data</span>, <span class="fl">12</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 4</span></span></span>
<span><span class="co">#&gt;    peptide_id condition replicate abundance</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> pep_0001   control           1     106. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> pep_0001   control           2      99.7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> pep_0001   control           3      36.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> pep_0001   control           4      62.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> pep_0001   treatment         1      66.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> pep_0001   treatment         2      50.9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> pep_0001   treatment         3      97.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> pep_0001   treatment         4      52.2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> pep_0002   control           1     143. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> pep_0002   control           2     295. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> pep_0002   control           3     216. </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> pep_0002   control           4      89.0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fit-distributions">Fit Distributions<a class="anchor" aria-label="anchor" href="#fit-distributions"></a>
</h2>
<p>Use <code><a href="../reference/fit_distributions.html">fit_distributions()</a></code> to determine which statistical
distributions best describe your peptide abundance data.</p>
<p>The <code>distributions</code> parameter controls which distributions
are fitted: - <code>"continuous"</code> (default) - gamma, normal,
lognormal, etc. for abundance data - <code>"counts"</code> - includes
negative binomial for count-based quantification - <code>"all"</code> -
tries all distributions with auto-detection</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_distributions.html">fit_distributions</a></span><span class="op">(</span></span>
<span>  <span class="va">pilot_data</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"peptide_id"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"condition"</span>,</span>
<span>  value <span class="op">=</span> <span class="st">"abundance"</span>,</span>
<span>  distributions <span class="op">=</span> <span class="st">"continuous"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required namespace: intervals</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span></span>
<span><span class="co">#&gt; peppwr_fits object</span></span>
<span><span class="co">#&gt; ------------------</span></span>
<span><span class="co">#&gt; 200 peptides fitted</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Best fit distribution counts:</span></span>
<span><span class="co">#&gt;   Gamma: 13</span></span>
<span><span class="co">#&gt;   Normal: 22</span></span>
<span><span class="co">#&gt;   Pareto: 124</span></span>
<span><span class="co">#&gt;   Skew Normal: 41</span></span></code></pre></div>
<p>The output shows how many peptides are best fit by each distribution.
This helps you understand the statistical properties of your data.</p>
<div class="section level3">
<h3 id="visualize-distribution-fits">Visualize Distribution Fits<a class="anchor" aria-label="anchor" href="#visualize-distribution-fits"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/plot-fits-1.png" class="r-plt" alt="" width="672"></p>
<p>The plot shows the count of best-fit distributions by two metrics: -
<strong>AIC</strong> (Akaike Information Criterion): Balances fit
quality with model complexity - <strong>LogLikelihood</strong>: Pure
goodness-of-fit measure</p>
<p>When these metrics agree, you can be confident about the distribution
choice.</p>
</div>
</div>
<div class="section level2">
<h2 id="assess-fit-quality">Assess Fit Quality<a class="anchor" aria-label="anchor" href="#assess-fit-quality"></a>
</h2>
<p>With larger pilot datasets (n≥15 per group), you can visually assess
fit quality using diagnostic plots. peppwR provides two options:</p>
<p><strong>Density overlay</strong> - overlays fitted density curves on
observed histograms:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Visual check: does the fitted distribution match the data?</span></span>
<span><span class="fu"><a href="../reference/plot_density_overlay.html">plot_density_overlay</a></span><span class="op">(</span><span class="va">fits</span>, n_overlay <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><strong>QQ plots</strong> - compare observed vs theoretical
quantiles:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Goodness-of-fit assessment via QQ plots</span></span>
<span><span class="fu"><a href="../reference/plot_qq.html">plot_qq</a></span><span class="op">(</span><span class="va">fits</span>, n_plots <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p>With our small pilot data (n=4 per group), these plots are not very
informative - there are simply too few points per peptide for meaningful
visual assessment. See <code>vignette("power-analysis-workflow")</code>
for examples with larger datasets.</p>
<p>If fits look poor, consider: - Using different candidate
distributions - Checking for outliers or data quality issues - Using
<code>on_fit_failure = "empirical"</code> in power analysis to bootstrap
from raw data</p>
</div>
<div class="section level2">
<h2 id="a-note-on-sample-size-and-distribution-detection">A Note on Sample Size and Distribution Detection<a class="anchor" aria-label="anchor" href="#a-note-on-sample-size-and-distribution-detection"></a>
</h2>
<p>With small pilot datasets (n=4 per group = 8 observations per
peptide), the “best” distribution may not match the true underlying
distribution. Our synthetic data was generated from Gamma distributions,
but with small samples you may see Pareto or Skew Normal selected as
“best.”</p>
<p>Let’s verify that with larger samples, the correct distribution is
identified:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">42</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate data with larger sample size - 30 per group</span></span>
<span><span class="va">large_n_data</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  peptide_id <span class="op">=</span> <span class="st">"test_peptide"</span>,</span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"treatment"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>  replicate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>  abundance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">60</span>, shape <span class="op">=</span> <span class="fl">3</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>  <span class="co"># True distribution: Gamma</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">large_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_distributions.html">fit_distributions</a></span><span class="op">(</span></span>
<span>  <span class="va">large_n_data</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"peptide_id"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"condition"</span>,</span>
<span>  value <span class="op">=</span> <span class="st">"abundance"</span>,</span>
<span>  distributions <span class="op">=</span> <span class="st">"continuous"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">large_fits</span><span class="op">)</span></span>
<span><span class="co">#&gt; peppwr_fits object</span></span>
<span><span class="co">#&gt; ------------------</span></span>
<span><span class="co">#&gt; 2 peptides fitted</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Best fit distribution counts:</span></span>
<span><span class="co">#&gt;   Gamma: 2</span></span></code></pre></div>
<p>With 30 samples per group, the Gamma distribution is correctly
identified as best fit.</p>
<p><strong>Takeaway:</strong> For small pilot studies, interpret the
“best fit” as “best among candidates given limited data” rather than
definitive truth. The fitted parameters are still useful for power
simulation regardless of which distribution family is selected.</p>
</div>
<div class="section level2">
<h2 id="power-analysis---aggregate-mode">Power Analysis - Aggregate Mode<a class="anchor" aria-label="anchor" href="#power-analysis---aggregate-mode"></a>
</h2>
<p>If you don’t have pilot data, or want a quick ballpark estimate, use
<strong>aggregate mode</strong>. You specify an assumed distribution and
parameters.</p>
<div class="section level3">
<h3 id="finding-required-sample-size">Finding Required Sample Size<a class="anchor" aria-label="anchor" href="#finding-required-sample-size"></a>
</h3>
<p>“How many samples do I need per group to achieve 80% power for
detecting a 2-fold change?”</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span></span>
<span>  distribution <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  effect_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  target_power <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  find <span class="op">=</span> <span class="st">"sample_size"</span>,</span>
<span>  n_sim <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_n</span><span class="op">)</span></span>
<span><span class="co">#&gt; peppwr_power analysis</span></span>
<span><span class="co">#&gt; ---------------------</span></span>
<span><span class="co">#&gt; Mode: aggregate</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Recommended sample size: N=25 per group</span></span>
<span><span class="co">#&gt; Target power: 80%</span></span>
<span><span class="co">#&gt; Effect size: 2.00-fold</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Significance level: 0.05</span></span>
<span><span class="co">#&gt; Statistical test: wilcoxon</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_n</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/plot-aggregate-sample-size-1.png" class="r-plt" alt="" width="672"></p>
<p>The plot shows the power curve with your target power and the
recommended sample size highlighted.</p>
</div>
<div class="section level3">
<h3 id="finding-power-at-fixed-n">Finding Power at Fixed N<a class="anchor" aria-label="anchor" href="#finding-power-at-fixed-n"></a>
</h3>
<p>“What’s my power to detect a 2-fold change with N=6 per group?”</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span></span>
<span>  distribution <span class="op">=</span> <span class="st">"gamma"</span>,</span>
<span>  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="fl">2</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>  effect_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  n_per_group <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  find <span class="op">=</span> <span class="st">"power"</span>,</span>
<span>  n_sim <span class="op">=</span> <span class="fl">1000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_power</span><span class="op">)</span></span>
<span><span class="co">#&gt; peppwr_power analysis</span></span>
<span><span class="co">#&gt; ---------------------</span></span>
<span><span class="co">#&gt; Mode: aggregate</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power: 24%</span></span>
<span><span class="co">#&gt; Sample size: 6 per group</span></span>
<span><span class="co">#&gt; Effect size: 2.00-fold</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Significance level: 0.05</span></span>
<span><span class="co">#&gt; Statistical test: wilcoxon</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="power-analysis---per-peptide-mode">Power Analysis - Per-Peptide Mode<a class="anchor" aria-label="anchor" href="#power-analysis---per-peptide-mode"></a>
</h2>
<p>When you have pilot data, use <strong>per-peptide mode</strong> for
more accurate, peptide-specific power estimates. This mode: 1. Uses the
fitted distribution for each peptide 2. Simulates power individually 3.
Reports what proportion of your peptidome reaches target power</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_pp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span></span>
<span>  <span class="va">fits</span>,</span>
<span>  effect_size <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  target_power <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  find <span class="op">=</span> <span class="st">"sample_size"</span>,</span>
<span>  n_sim <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_pp</span><span class="op">)</span></span>
<span><span class="co">#&gt; peppwr_power analysis</span></span>
<span><span class="co">#&gt; ---------------------</span></span>
<span><span class="co">#&gt; Mode: per_peptide</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Recommended sample size: N=12 per group</span></span>
<span><span class="co">#&gt; Target power: 80%</span></span>
<span><span class="co">#&gt; Effect size: 2.00-fold</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Significance level: 0.05</span></span>
<span><span class="co">#&gt; Statistical test: wilcoxon</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result_pp</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/plot-per-peptide-1.png" class="r-plt" alt="" width="672"></p>
<p>This plot shows what percentage of peptides achieve your target power
at each sample size. The 50% line indicates where the majority of
peptides are well-powered.</p>
<div class="section level3">
<h3 id="interpreting-per-peptide-results">Interpreting Per-Peptide Results<a class="anchor" aria-label="anchor" href="#interpreting-per-peptide-results"></a>
</h3>
<p>Unlike aggregate mode, per-peptide mode acknowledges that <strong>not
all peptides behave the same</strong>. Some peptides may require more
samples due to higher variance, while others achieve target power with
fewer samples.</p>
<p>The “% of peptides at target power” metric helps you understand: - At
what N do most peptides become well-powered? - What fraction of peptides
will remain underpowered even with larger samples?</p>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<table class="table">
<colgroup>
<col width="22%">
<col width="48%">
<col width="29%">
</colgroup>
<thead><tr class="header">
<th>Mode</th>
<th>When to Use</th>
<th>Output</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Aggregate</td>
<td>No pilot data, quick estimate</td>
<td>Single power/N estimate</td>
</tr>
<tr class="even">
<td>Per-peptide</td>
<td>Have pilot data</td>
<td>Distribution of power across peptidome</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<ul>
<li>
<strong>Power Analysis Workflow</strong>: See
<code>vignette("power-analysis-workflow")</code> for detailed guidance
on both modes, all three power questions, and statistical test
options.</li>
<li>
<strong>Benchmarking</strong>: See
<code>vignette("benchmarking")</code> for performance characteristics
with large datasets.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan MacLean.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
