<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Power Analysis for Targeted Proteomics with Missing Data (PRM) • peppwR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Power Analysis for Targeted Proteomics with Missing Data (PRM)">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">peppwR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Getting Started</a></li>
    <li><a class="dropdown-item" href="../articles/find-fits.html">Distribution Fitting</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>In-depth Guides</h6></li>
    <li><a class="dropdown-item" href="../articles/power-analysis-workflow.html">Power Analysis Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/benchmarking.html">Benchmarking</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Real-World Examples</h6></li>
    <li><a class="dropdown-item" href="../articles/dda-time-course-power.html">DDA Time Course Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/prm-genotype-power.html">PRM Genotype Analysis</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/TeamMacLean/peppwR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Power Analysis for Targeted Proteomics with Missing Data (PRM)</h1>
                        <h4 data-toc-skip class="author">peppwR</h4>
            
            <h4 data-toc-skip class="date">2026-02-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/TeamMacLean/peppwR/blob/master/vignettes/articles/prm-genotype-power.Rmd" class="external-link"><code>vignettes/articles/prm-genotype-power.Rmd</code></a></small>
      <div class="d-none name"><code>prm-genotype-power.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="what-makes-targeted-proteomics-different">What Makes Targeted Proteomics Different?<a class="anchor" aria-label="anchor" href="#what-makes-targeted-proteomics-different"></a>
</h3>
<p>Mass spectrometry-based proteomics operates in two fundamentally
different modes:</p>
<p><strong>Discovery proteomics (DDA)</strong> casts a wide net:</p>
<ul>
<li>Measures thousands of proteins/peptides</li>
<li>Identifies whatever is abundant enough to detect</li>
<li>Great for hypothesis generation</li>
<li>High multiple testing burden</li>
</ul>
<p><strong>Targeted proteomics (PRM/SRM)</strong> takes aim at specific
targets:</p>
<ul>
<li>Measures a pre-defined panel of peptides</li>
<li>Higher sensitivity and reproducibility</li>
<li>Better for hypothesis testing</li>
<li>Lower multiple testing burden</li>
</ul>
<p>This document analyzes a PRM dataset, demonstrating how peppwR
handles the unique challenges of targeted proteomics, including missing
data and FDR considerations.</p>
</div>
<div class="section level3">
<h3 id="the-missing-data-challenge">The Missing Data Challenge<a class="anchor" aria-label="anchor" href="#the-missing-data-challenge"></a>
</h3>
<p>Even with targeted methods, missing values are ubiquitous in mass
spectrometry. But not all missing data is created equal:</p>
<p><strong>MCAR (Missing Completely At Random)</strong></p>
<ul>
<li>Values missing due to random technical failures</li>
<li>No relationship to abundance</li>
<li>Reduces sample size but doesn’t bias results</li>
</ul>
<p><strong>MNAR (Missing Not At Random)</strong></p>
<ul>
<li>Low-abundance peptides systematically missing</li>
<li>Below detection limit = no measurement</li>
<li>Can bias abundance estimates upward</li>
<li>Common in mass spectrometry</li>
</ul>
<p>peppwR tracks both the rate of missingness AND evidence for MNAR
patterns, enabling more realistic power estimates.</p>
</div>
<div class="section level3">
<h3 id="goals-of-this-analysis">Goals of This Analysis<a class="anchor" aria-label="anchor" href="#goals-of-this-analysis"></a>
</h3>
<ol style="list-style-type: decimal">
<li>Characterize missingness patterns in the data</li>
<li>Identify peptides with MNAR evidence</li>
<li>Compare statistical tests at small sample sizes</li>
<li>Determine realistic sample size requirements</li>
<li>Understand FDR impact on power</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="about-the-data">About the Data<a class="anchor" aria-label="anchor" href="#about-the-data"></a>
</h2>
<p>This analysis uses fungal phosphoproteomics data from a targeted PRM
experiment:</p>
<table class="table">
<thead><tr class="header">
<th>Property</th>
<th>Value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Organism</td>
<td>
<em>Magnaporthe oryzae</em> (rice blast fungus)</td>
</tr>
<tr class="even">
<td>Method</td>
<td>PRM (Parallel Reaction Monitoring)</td>
</tr>
<tr class="odd">
<td>Comparison</td>
<td>Early (t=0) vs late (t=6) timepoints</td>
</tr>
<tr class="even">
<td>Biological replicates</td>
<td>3 per condition</td>
</tr>
<tr class="odd">
<td>Technical replicates</td>
<td>2 per biological replicate</td>
</tr>
<tr class="even">
<td>Peptides</td>
<td>285 phosphopeptides</td>
</tr>
<tr class="odd">
<td>Missing data</td>
<td>~17%</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="data-preparation">Data Preparation<a class="anchor" aria-label="anchor" href="#data-preparation"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://teammaclean.github.io/peppwR/">peppwR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load the PRM experiment data</span></span>
<span><span class="va">prm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"../../sample_data/prm_data.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the structure</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">prm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Rows: 20,520</span></span>
<span><span class="co">## Columns: 7</span></span>
<span><span class="co">## $ molecule_list_name        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "gi|145601729|ref|XP_363034.2|"<span style="color: #949494;">, </span>"gi|1456017…</span></span>
<span><span class="co">## $ peptide_modified_sequence <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "KLS[+80]ASGS[+80]PGSVNLGR"<span style="color: #949494;">, </span>"KLS[+80]ASGS[+…</span></span>
<span><span class="co">## $ genotype                  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "Guy11"<span style="color: #949494;">, </span>"Guy11"<span style="color: #949494;">, </span>"Guy11"<span style="color: #949494;">, </span>"Guy11"<span style="color: #949494;">, </span>"Guy11"<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">## $ timepoint                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0<span style="color: #949494;">, </span>0.0<span style="color: #949494;">, </span>0.0<span style="color: #949494;">, </span>0.0<span style="color: #949494;">, </span>0.0<span style="color: #949494;">, </span>0.0<span style="color: #949494;">, </span>1.0<span style="color: #949494;">, </span>1.0<span style="color: #949494;">, </span>1.0<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">## $ bio_rep                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>3<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">## $ tech_rep                  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">, </span>2<span style="color: #949494;">, </span>1<span style="color: #949494;">,</span>…</span></span>
<span><span class="co">## $ total_area                <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.031275e-03<span style="color: #949494;">, </span>1.130267e-03<span style="color: #949494;">, </span>5.243216e-04<span style="color: #949494;">, </span>2.…</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check for missing values in raw data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Total observations:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">prm</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Total observations: 20520</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Missing values:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">prm</span><span class="op">$</span><span class="va">total_area</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Missing values: 3547</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Missing rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">prm</span><span class="op">$</span><span class="va">total_area</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Missing rate: 17.3 %</span></span></code></pre>
<div class="section level3">
<h3 id="why-average-technical-replicates">Why Average Technical Replicates?<a class="anchor" aria-label="anchor" href="#why-average-technical-replicates"></a>
</h3>
<p>Technical replicates measure the same biological sample multiple
times. They capture <em>measurement</em> variability, not
<em>biological</em> variability.</p>
<p>For power analysis, biological replicates are the true unit of
replication - they represent independent observations of the biological
phenomenon we’re studying. We average technical replicates to get one
value per biological replicate.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Filter to early (0) vs late (6) timepoints</span></span>
<span><span class="co"># Average technical replicates within each biological replicate</span></span>
<span><span class="va">pilot</span> <span class="op">&lt;-</span> <span class="va">prm</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">timepoint</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">peptide_modified_sequence</span>, <span class="va">genotype</span>, <span class="va">timepoint</span>, <span class="va">bio_rep</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>abundance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">total_area</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/transmute.html" class="external-link">transmute</a></span><span class="op">(</span></span>
<span>    peptide_id <span class="op">=</span> <span class="va">peptide_modified_sequence</span>,</span>
<span>    condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"t"</span>, <span class="va">timepoint</span><span class="op">)</span>,</span>
<span>    abundance <span class="op">=</span> <span class="va">abundance</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary statistics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Unique peptides:"</span>, <span class="fu"><a href="https://dplyr.tidyverse.org/reference/n_distinct.html" class="external-link">n_distinct</a></span><span class="op">(</span><span class="va">pilot</span><span class="op">$</span><span class="va">peptide_id</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Unique peptides: 285</span></span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Observations per condition:\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Observations per condition:</span></span></code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pilot</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">condition</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">##   condition     n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> t0         <span style="text-decoration: underline;">1</span>710</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> t6         <span style="text-decoration: underline;">1</span>710</span></span></code></pre>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check missingness after averaging technical replicates</span></span>
<span><span class="co"># (NaN results when both tech reps are NA)</span></span>
<span><span class="va">pilot</span> <span class="op">&lt;-</span> <span class="va">pilot</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>abundance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.nan</a></span><span class="op">(</span><span class="va">abundance</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">abundance</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Missing after averaging tech reps:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pilot</span><span class="op">$</span><span class="va">abundance</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Missing after averaging tech reps: 429</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Missing rate:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pilot</span><span class="op">$</span><span class="va">abundance</span><span class="op">)</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Missing rate: 12.5 %</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="missingness-analysis">Missingness Analysis<a class="anchor" aria-label="anchor" href="#missingness-analysis"></a>
</h2>
<div class="section level3">
<h3 id="examining-the-extent-of-missingness">Examining the Extent of Missingness<a class="anchor" aria-label="anchor" href="#examining-the-extent-of-missingness"></a>
</h3>
<p>Before diving into power analysis, we need to understand our missing
data. peppwR automatically computes missingness statistics during
distribution fitting.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit distributions - missingness is tracked automatically</span></span>
<span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit_distributions.html">fit_distributions</a></span><span class="op">(</span><span class="va">pilot</span>, <span class="st">"peptide_id"</span>, <span class="st">"condition"</span>, <span class="st">"abundance"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary includes missingness information</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## peppwr_fits object</span></span>
<span><span class="co">## ------------------</span></span>
<span><span class="co">## 570 peptides fitted</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Best fit distribution counts:</span></span>
<span><span class="co">##   Gamma: 103</span></span>
<span><span class="co">##   Inverse Gaussian: 36</span></span>
<span><span class="co">##   InvGamma: 2</span></span>
<span><span class="co">##   Lognormal: 5</span></span>
<span><span class="co">##   Normal: 90</span></span>
<span><span class="co">##   Pareto: 273</span></span>
<span><span class="co">##   Skew Normal: 61</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Missingness: 429/3420 values NA (12.5%)</span></span>
<span><span class="co">## Peptides with missing data: 180</span></span>
<span><span class="co">##   MNAR pattern: 0 of 180 peptides with missing data (score &gt; 2)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="visualizing-missingness-patterns">Visualizing Missingness Patterns<a class="anchor" aria-label="anchor" href="#visualizing-missingness-patterns"></a>
</h3>
<p>The <code><a href="../reference/plot_missingness.html">plot_missingness()</a></code> function provides three
complementary views:</p>
<ol style="list-style-type: decimal">
<li>
<strong>NA Rate Distribution</strong>: What fraction of observations
are missing for each peptide?</li>
<li>
<strong>MNAR Score Distribution</strong>: Is there evidence that
missingness correlates with abundance?</li>
<li>
<strong>Abundance vs NA Rate</strong>: Do low-abundance peptides
have more missing values?</li>
</ol>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_missingness.html">plot_missingness</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="prm-genotype-power_files/figure-html/plot-missingness-1.png" class="r-plt" alt="Missingness patterns across the PRM peptidome. Left: Distribution of NA rates. Middle: MNAR scores (z-statistic; values &gt; 2 suggest informative missingness). Right: Relationship between mean abundance and NA rate." width="768"><p class="caption">
Missingness patterns across the PRM peptidome. Left: Distribution of NA
rates. Middle: MNAR scores (z-statistic; values &gt; 2 suggest
informative missingness). Right: Relationship between mean abundance and
NA rate.
</p>
</div>
</div>
<div class="section level3">
<h3 id="interpreting-mnar-scores">Interpreting MNAR Scores<a class="anchor" aria-label="anchor" href="#interpreting-mnar-scores"></a>
</h3>
<p>The MNAR score is a z-statistic testing whether missing observations
have systematically different (lower) abundance than observed values.
Higher scores indicate stronger evidence for informative
missingness.</p>
<table class="table">
<thead><tr class="header">
<th>MNAR Score</th>
<th>Interpretation</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>&lt; 1</td>
<td>Little evidence for MNAR</td>
</tr>
<tr class="even">
<td>1-2</td>
<td>Weak evidence</td>
</tr>
<tr class="odd">
<td>2-3</td>
<td>Moderate evidence</td>
</tr>
<tr class="even">
<td>&gt; 3</td>
<td>Strong evidence for MNAR</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Identify peptides with strong MNAR evidence</span></span>
<span><span class="va">mnar_peptides</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_mnar_peptides.html">get_mnar_peptides</a></span><span class="op">(</span><span class="va">fits</span>, threshold <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Peptides with MNAR evidence (z &gt; 2):"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mnar_peptides</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Peptides with MNAR evidence (z &gt; 2): 0</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mnar_peptides</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nTop MNAR peptides:\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mnar_peptides</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="what-to-do-with-mnar-peptides">What to Do with MNAR Peptides<a class="anchor" aria-label="anchor" href="#what-to-do-with-mnar-peptides"></a>
</h3>
<p>Peptides with high MNAR scores require careful handling:</p>
<ul>
<li>Their abundance estimates may be biased upward (low values are
missing)</li>
<li>Power calculations may be optimistic</li>
<li>Consider robust statistical methods</li>
<li>Report separately in publications</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="distribution-fitting-results">Distribution Fitting Results<a class="anchor" aria-label="anchor" href="#distribution-fitting-results"></a>
</h2>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="prm-genotype-power_files/figure-html/plot-fits-1.png" class="r-plt" alt="Best-fit distribution counts for PRM data." width="768"><p class="caption">
Best-fit distribution counts for PRM data.
</p>
</div>
<div class="section level3">
<h3 id="interpreting-distribution-fitting-a-cautionary-note">Interpreting Distribution Fitting: A Cautionary Note<a class="anchor" aria-label="anchor" href="#interpreting-distribution-fitting-a-cautionary-note"></a>
</h3>
<p><strong>Important:</strong> Like the DDA dataset, we see that certain
distributions may dominate the “best fit” counts. This is an
<strong>artifact of small sample size</strong> (only 6 observations per
peptide when averaged across tech reps), not a statement about true
underlying distributions.</p>
<p>With more biological replicates, we would expect gamma and lognormal
distributions to fit better - these are the typical distributions for
mass spectrometry abundance data.</p>
</div>
<div class="section level3">
<h3 id="parameter-distribution">Parameter Distribution<a class="anchor" aria-label="anchor" href="#parameter-distribution"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_param_distribution.html">plot_param_distribution</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="prm-genotype-power_files/figure-html/param-dist-1.png" class="r-plt" alt="Distribution of AIC values across peptides for each fitted distribution." width="768"><p class="caption">
Distribution of AIC values across peptides for each fitted distribution.
</p>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Count peptides per best-fit distribution</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nPeptides per best-fit distribution:\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Peptides per best-fit distribution:</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>distribution <span class="op">=</span> <span class="va">fits</span><span class="op">$</span><span class="va">best</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">distribution</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 7 × 2</span></span></span>
<span><span class="co">##   distribution         n</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> Pareto             273</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> Gamma              103</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> Normal              90</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> Skew Normal         61</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> Inverse Gaussian    36</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> Lognormal            5</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">7</span> InvGamma             2</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="power-analysis">Power Analysis<a class="anchor" aria-label="anchor" href="#power-analysis"></a>
</h2>
<div class="section level3">
<h3 id="choosing-the-right-statistical-test">Choosing the Right Statistical Test<a class="anchor" aria-label="anchor" href="#choosing-the-right-statistical-test"></a>
</h3>
<p><strong>Critical first step:</strong> With small samples (N=3), test
choice dramatically affects power. Before committing to detailed
analyses, we compare available tests.</p>
<table class="table">
<colgroup>
<col width="20%">
<col width="20%">
<col width="58%">
</colgroup>
<thead><tr class="header">
<th>Test</th>
<th>Type</th>
<th>Characteristics</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Wilcoxon rank-sum</td>
<td>Non-parametric</td>
<td>Conservative, robust to outliers, needs larger N</td>
</tr>
<tr class="even">
<td>Bootstrap-t</td>
<td>Resampling</td>
<td>Handles non-normality through resampling</td>
</tr>
<tr class="odd">
<td>Bayes factor</td>
<td>Bayesian</td>
<td>Evidence-based, often more powerful at small N</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run all three tests (use n_sim = 100 for faster rendering)</span></span>
<span><span class="va">power_wilcox</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span><span class="va">fits</span>, effect_size <span class="op">=</span> <span class="fl">2</span>, n_per_group <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                find <span class="op">=</span> <span class="st">"power"</span>, test <span class="op">=</span> <span class="st">"wilcoxon"</span>, n_sim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">power_boot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span><span class="va">fits</span>, effect_size <span class="op">=</span> <span class="fl">2</span>, n_per_group <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                              find <span class="op">=</span> <span class="st">"power"</span>, test <span class="op">=</span> <span class="st">"bootstrap_t"</span>, n_sim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">power_bayes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span><span class="va">fits</span>, effect_size <span class="op">=</span> <span class="fl">2</span>, n_per_group <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                               find <span class="op">=</span> <span class="st">"power"</span>, test <span class="op">=</span> <span class="st">"bayes_t"</span>, n_sim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create comparison table</span></span>
<span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>  Test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wilcoxon rank-sum"</span>, <span class="st">"Bootstrap-t"</span>, <span class="st">"Bayes factor"</span><span class="op">)</span>,</span>
<span>  `Median Power` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">power_wilcox</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">power_boot</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">power_bayes</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  `% &gt; 50% Power` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">power_wilcox</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">power_boot</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">power_bayes</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span> <span class="op">&gt;</span> <span class="fl">0.5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span>,</span>
<span>  `% &gt; 80% Power` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">power_wilcox</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span> <span class="op">&gt;</span> <span class="fl">0.8</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">power_boot</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span> <span class="op">&gt;</span> <span class="fl">0.8</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">power_bayes</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span> <span class="op">&gt;</span> <span class="fl">0.8</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">comparison</span>, digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>             caption <span class="op">=</span> <span class="st">"Power comparison across statistical tests (N=3, 2-fold effect)"</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Power comparison across statistical tests (N=3, 2-fold
effect)</caption>
<thead><tr class="header">
<th align="left">Test</th>
<th align="right">Median Power</th>
<th align="right">% &gt; 50% Power</th>
<th align="right">% &gt; 80% Power</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Wilcoxon rank-sum</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
<td align="right">0.00</td>
</tr>
<tr class="even">
<td align="left">Bootstrap-t</td>
<td align="right">0.20</td>
<td align="right">11.31</td>
<td align="right">4.74</td>
</tr>
<tr class="odd">
<td align="left">Bayes factor</td>
<td align="right">0.55</td>
<td align="right">61.31</td>
<td align="right">16.42</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="understanding-the-test-comparison-results">Understanding the Test Comparison Results<a class="anchor" aria-label="anchor" href="#understanding-the-test-comparison-results"></a>
</h3>
<p>The table above shows how different tests perform at small sample
sizes:</p>
<ul>
<li><p><strong>Wilcoxon rank-sum</strong> is conservative -
non-parametric tests trade statistical assumptions for larger sample
size requirements.</p></li>
<li><p><strong>Bootstrap-t</strong> uses resampling to handle
non-normality, potentially offering intermediate power.</p></li>
<li><p><strong>Bayes factor</strong> tests quantify evidence for an
effect, often performing better at small N.</p></li>
</ul>
<p><strong>For remaining analyses:</strong> We use the Bayes factor test
since it provides usable power estimates at N=3.</p>
</div>
<div class="section level3">
<h3 id="the-three-questions">The Three Questions<a class="anchor" aria-label="anchor" href="#the-three-questions"></a>
</h3>
<p>Power analysis can answer three related questions:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Power:</strong> Given N and effect size, what power do we
have?</li>
<li>
<strong>Sample size:</strong> Given target power and effect size,
what N do we need?</li>
<li>
<strong>Minimum detectable effect:</strong> Given N and target
power, what effect can we detect?</li>
</ol>
</div>
<div class="section level3">
<h3 id="question-1-what-power-do-we-have">Question 1: What Power Do We Have?<a class="anchor" aria-label="anchor" href="#question-1-what-power-do-we-have"></a>
</h3>
<p>With 3 biological replicates and a 2-fold effect, what power do we
achieve?</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using Bayes factor test based on comparison results</span></span>
<span><span class="va">power_current</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span><span class="va">fits</span>, effect_size <span class="op">=</span> <span class="fl">2</span>, n_per_group <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                 find <span class="op">=</span> <span class="st">"power"</span>, test <span class="op">=</span> <span class="st">"bayes_t"</span>, n_sim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">power_current</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## peppwr_power analysis</span></span>
<span><span class="co">## ---------------------</span></span>
<span><span class="co">## Mode: per_peptide</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Power: 60%</span></span>
<span><span class="co">## Sample size: 3 per group</span></span>
<span><span class="co">## Effect size: 2.00-fold</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Significance level: 0.05</span></span>
<span><span class="co">## Statistical test: bayes_t</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">power_current</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="prm-genotype-power_files/figure-html/plot-power-current-1.png" class="r-plt" alt="Distribution of power across peptides with N=3 and 2-fold effect (Bayes factor test)." width="768"><p class="caption">
Distribution of power across peptides with N=3 and 2-fold effect (Bayes
factor test).
</p>
</div>
</div>
<div class="section level3">
<h3 id="question-2-what-sample-size-do-we-need">Question 2: What Sample Size Do We Need?<a class="anchor" aria-label="anchor" href="#question-2-what-sample-size-do-we-need"></a>
</h3>
<p>What N would achieve 80% power to detect a 2-fold change?</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span><span class="va">fits</span>, effect_size <span class="op">=</span> <span class="fl">2</span>, target_power <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                              find <span class="op">=</span> <span class="st">"sample_size"</span>, test <span class="op">=</span> <span class="st">"bayes_t"</span>, n_sim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## peppwr_power analysis</span></span>
<span><span class="co">## ---------------------</span></span>
<span><span class="co">## Mode: per_peptide</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Recommended sample size: N=10 per group</span></span>
<span><span class="co">## Target power: 80%</span></span>
<span><span class="co">## Effect size: 2.00-fold</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Significance level: 0.05</span></span>
<span><span class="co">## Statistical test: bayes_t</span></span></code></pre>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="prm-genotype-power_files/figure-html/plot-sample-size-1.png" class="r-plt" alt="Percentage of peptides achieving 80% power at each sample size." width="768"><p class="caption">
Percentage of peptides achieving 80% power at each sample size.
</p>
</div>
</div>
<div class="section level3">
<h3 id="question-3-whats-the-minimum-detectable-effect">Question 3: What’s the Minimum Detectable Effect?<a class="anchor" aria-label="anchor" href="#question-3-whats-the-minimum-detectable-effect"></a>
</h3>
<p>At N=3, what’s the smallest effect we can reliably detect?</p>
<p><strong>Understanding the two thresholds:</strong> In per-peptide
mode, there are two distinct thresholds:</p>
<ol style="list-style-type: decimal">
<li>
<strong><code>target_power</code></strong> (set to 0.8) - The power
level each individual peptide must achieve</li>
<li>
<strong><code>proportion_threshold</code></strong> (default 0.5) -
The fraction of peptides that must reach <code>target_power</code>
</li>
</ol>
<p>The plot shows “% of peptides reaching 80% power” on the y-axis. The
answer tells us: “At what effect size do 50% of peptides achieve 80%
power?”</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">min_effect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span><span class="va">fits</span>, n_per_group <span class="op">=</span> <span class="fl">3</span>, target_power <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                             find <span class="op">=</span> <span class="st">"effect_size"</span>, test <span class="op">=</span> <span class="st">"bayes_t"</span>, n_sim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">min_effect</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## peppwr_power analysis</span></span>
<span><span class="co">## ---------------------</span></span>
<span><span class="co">## Mode: per_peptide</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Minimum detectable effect: 5.00-fold</span></span>
<span><span class="co">## Sample size: 3 per group</span></span>
<span><span class="co">## Target power: 80%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Significance level: 0.05</span></span>
<span><span class="co">## Statistical test: bayes_t</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">min_effect</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="prm-genotype-power_files/figure-html/plot-min-effect-1.png" class="r-plt" alt="Proportion of peptides reaching 80% power at each effect size. The default threshold is 50% of peptides." width="768"><p class="caption">
Proportion of peptides reaching 80% power at each effect size. The
default threshold is 50% of peptides.
</p>
</div>
<p>This tells us what effect sizes are realistically detectable with
current sample sizes. To require more peptides to be well-powered,
increase <code>proportion_threshold</code>.</p>
</div>
<div class="section level3">
<h3 id="impact-of-missingness-on-power">Impact of Missingness on Power<a class="anchor" aria-label="anchor" href="#impact-of-missingness-on-power"></a>
</h3>
<p>How does accounting for missingness affect power estimates?</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Power without accounting for missingness (optimistic)</span></span>
<span><span class="va">power_no_miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span><span class="va">fits</span>, effect_size <span class="op">=</span> <span class="fl">2</span>, n_per_group <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                 find <span class="op">=</span> <span class="st">"power"</span>, test <span class="op">=</span> <span class="st">"bayes_t"</span>,</span>
<span>                                 include_missingness <span class="op">=</span> <span class="cn">FALSE</span>, n_sim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Power accounting for missingness (realistic)</span></span>
<span><span class="va">power_with_miss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span><span class="va">fits</span>, effect_size <span class="op">=</span> <span class="fl">2</span>, n_per_group <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                   find <span class="op">=</span> <span class="st">"power"</span>, test <span class="op">=</span> <span class="st">"bayes_t"</span>,</span>
<span>                                   include_missingness <span class="op">=</span> <span class="cn">TRUE</span>, n_sim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Median power WITHOUT missingness:"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">power_no_miss</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Median power WITHOUT missingness: 0.57</span></span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Median power WITH missingness:   "</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">power_with_miss</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Median power WITH missingness:    0.56</span></span></code></pre>
<p>Accounting for missingness typically reduces power estimates - this
is the realistic cost of missing data on your experiment’s ability to
detect effects.</p>
</div>
</div>
<div class="section level2">
<h2 id="fdr-aware-power-analysis">FDR-Aware Power Analysis<a class="anchor" aria-label="anchor" href="#fdr-aware-power-analysis"></a>
</h2>
<div class="section level3">
<h3 id="why-fdr-matters">Why FDR Matters<a class="anchor" aria-label="anchor" href="#why-fdr-matters"></a>
</h3>
<p>With 285 peptides tested, multiple testing is a concern. If we use
alpha = 0.05 for each test, we expect ~14 false positives by chance
alone (285 x 0.05 = 14.25).</p>
<p>FDR (False Discovery Rate) control methods like Benjamini-Hochberg
adjust p-values to control the expected proportion of false discoveries.
This is more stringent than nominal testing and reduces power.</p>
</div>
<div class="section level3">
<h3 id="understanding-prop_null">Understanding <code>prop_null</code><a class="anchor" aria-label="anchor" href="#understanding-prop_null"></a>
</h3>
<p>The <code>prop_null</code> parameter specifies the assumed proportion
of true null hypotheses - peptides with no real effect. This affects FDR
correction stringency:</p>
<table class="table">
<thead><tr class="header">
<th><code>prop_null</code></th>
<th>Meaning</th>
<th>Impact</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>0.9</td>
<td>90% of peptides have no effect</td>
<td>More stringent correction</td>
</tr>
<tr class="even">
<td>0.5</td>
<td>50% have real effects</td>
<td>Less stringent correction</td>
</tr>
</tbody>
</table>
<p>In targeted proteomics, you typically select peptides expected to
change, so <code>prop_null</code> might be lower than in discovery
experiments.</p>
</div>
<div class="section level3">
<h3 id="standard-vs-fdr-corrected-power">Standard vs FDR-Corrected Power<a class="anchor" aria-label="anchor" href="#standard-vs-fdr-corrected-power"></a>
</h3>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Standard power (nominal alpha = 0.05)</span></span>
<span><span class="va">power_nominal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span><span class="va">fits</span>, effect_size <span class="op">=</span> <span class="fl">2</span>, n_per_group <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                                find <span class="op">=</span> <span class="st">"power"</span>, test <span class="op">=</span> <span class="st">"bayes_t"</span>,</span>
<span>                                apply_fdr <span class="op">=</span> <span class="cn">FALSE</span>, n_sim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># FDR-aware power (BH correction)</span></span>
<span><span class="co"># prop_null = 0.8 means we assume 80% of peptides have no true effect</span></span>
<span><span class="va">power_fdr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/power_analysis.html">power_analysis</a></span><span class="op">(</span><span class="va">fits</span>, effect_size <span class="op">=</span> <span class="fl">2</span>, n_per_group <span class="op">=</span> <span class="fl">3</span>,</span>
<span>                            find <span class="op">=</span> <span class="st">"power"</span>, test <span class="op">=</span> <span class="st">"bayes_t"</span>,</span>
<span>                            apply_fdr <span class="op">=</span> <span class="cn">TRUE</span>, prop_null <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                            fdr_threshold <span class="op">=</span> <span class="fl">0.05</span>, n_sim <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract power values safely</span></span>
<span><span class="va">nominal_power</span> <span class="op">&lt;-</span> <span class="va">power_nominal</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span></span>
<span><span class="va">fdr_power</span> <span class="op">&lt;-</span> <span class="va">power_fdr</span><span class="op">$</span><span class="va">simulations</span><span class="op">$</span><span class="va">peptide_power</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Nominal power (no FDR correction):\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Nominal power (no FDR correction):</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">nominal_power</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">nominal_power</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Median power:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">nominal_power</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  % peptides &gt; 80% power:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">nominal_power</span> <span class="op">&gt;</span> <span class="fl">0.8</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">power_nominal</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">##   Median power: 0.58 </span></span>
<span><span class="co">##   % peptides &gt; 80% power: 17.2 %</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nFDR-aware power (BH correction, 80% true nulls):\n"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## FDR-aware power (BH correction, 80% true nulls):</span></span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">fdr_power</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">fdr_power</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  Median power:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">fdr_power</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"  % peptides &gt; 80% power:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">fdr_power</span> <span class="op">&gt;</span> <span class="fl">0.8</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%\n"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">power_fdr</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## peppwr_power analysis</span></span>
<span><span class="co">## ---------------------</span></span>
<span><span class="co">## Mode: per_peptide</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Power: 8%</span></span>
<span><span class="co">## Sample size: 3 per group</span></span>
<span><span class="co">## Effect size: 2.00-fold</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Significance level: 0.05</span></span>
<span><span class="co">## Statistical test: bayes_t</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## FDR-adjusted analysis (Benjamini-Hochberg)</span></span>
<span><span class="co">## Proportion true nulls: 80%</span></span>
<span><span class="co">## FDR threshold: 5%</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="understanding-the-fdr-impact">Understanding the FDR Impact<a class="anchor" aria-label="anchor" href="#understanding-the-fdr-impact"></a>
</h3>
<p>FDR correction reduces power because:</p>
<ol style="list-style-type: decimal">
<li>
<strong>More evidence required:</strong> Adjusted p-values are
larger, requiring stronger effects to reach significance</li>
<li>
<strong>Depends on number of tests:</strong> More peptides = more
stringent correction</li>
<li>
<strong>Depends on true effect proportion:</strong> If most peptides
have true effects (<code>prop_null</code> is low), FDR correction is
less severe</li>
</ol>
<p>For a targeted panel of 285 peptides, the FDR impact is more modest
than for discovery proteomics with thousands of tests.</p>
</div>
</div>
<div class="section level2">
<h2 id="summary-and-recommendations">Summary and Recommendations<a class="anchor" aria-label="anchor" href="#summary-and-recommendations"></a>
</h2>
<div class="section level3">
<h3 id="key-findings">Key Findings<a class="anchor" aria-label="anchor" href="#key-findings"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>Missingness patterns:</strong> This PRM dataset has ~17%
missing values. Some peptides may show evidence of MNAR (informative
missingness), where low-abundance values are preferentially
missing.</p></li>
<li><p><strong>Distribution fitting:</strong> With only 6 observations
per peptide (after averaging tech reps), distribution selection is
unreliable. This is a small sample size artifact, not a reflection of
true underlying distributions.</p></li>
<li><p><strong>Test selection:</strong> Different statistical tests show
varying power at small N. Bayes factor tests can provide more
informative estimates than conservative non-parametric tests when
samples are limited.</p></li>
<li><p><strong>Missingness impact:</strong> Accounting for missing data
reduces power estimates - this reflects the real cost of
missingness.</p></li>
<li><p><strong>FDR impact:</strong> With 285 peptides, FDR correction
modestly reduces power compared to nominal testing.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="practical-recommendations">Practical Recommendations<a class="anchor" aria-label="anchor" href="#practical-recommendations"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p><strong>For future experiments:</strong> Consider N=6 or more
biological replicates for reliable detection of 2-fold changes.</p></li>
<li><p><strong>For current data:</strong> Set realistic expectations
about detectable effect sizes. Subtle changes may not be detectable with
N=3.</p></li>
<li><p><strong>Test selection:</strong> With small samples, Bayes factor
tests may be more informative than traditional frequentist
approaches.</p></li>
<li><p><strong>MNAR peptides:</strong> Report peptides with high MNAR
scores separately and interpret their results cautiously.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="targeted-vs-discovery-considerations">Targeted vs Discovery Considerations<a class="anchor" aria-label="anchor" href="#targeted-vs-discovery-considerations"></a>
</h3>
<p>This PRM dataset (285 peptides) has advantages over discovery
proteomics:</p>
<ul>
<li>
<strong>Lower multiple testing burden:</strong> Fewer tests = less
severe FDR correction</li>
<li>
<strong>Focused power:</strong> Resources concentrated on peptides
of interest</li>
<li>
<strong>Better reproducibility:</strong> Targeted methods have lower
technical variability</li>
</ul>
<p>However:</p>
<ul>
<li>
<strong>No discovery:</strong> Can’t detect unexpected changes</li>
<li>
<strong>Panel bias:</strong> Limited to pre-selected targets</li>
</ul>
</div>
<div class="section level3">
<h3 id="caveats">Caveats<a class="anchor" aria-label="anchor" href="#caveats"></a>
</h3>
<ul>
<li>This analysis combines both genotypes; genotype-specific analyses
may differ</li>
<li>Technical replicate averaging reduces noise but masks technical
variability</li>
<li>MNAR models are approximations; true missing data mechanisms may be
more complex</li>
<li>The <code>prop_null</code> parameter requires assumptions about true
effect rates</li>
<li>Distribution fitting is limited by small sample size</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.5.2 (2025-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices datasets  utils     methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] tibble_3.3.1  ggplot2_4.0.2 dplyr_1.2.0   peppwR_0.1.0 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] sass_0.4.10         utf8_1.2.6          generics_0.1.4     </span></span>
<span><span class="co">##  [4] tidyr_1.3.2         renv_0.12.2         lattice_0.22-7     </span></span>
<span><span class="co">##  [7] fGarch_4052.93      digest_0.6.39       magrittr_2.0.4     </span></span>
<span><span class="co">## [10] evaluate_1.0.5      grid_4.5.2          RColorBrewer_1.1-3 </span></span>
<span><span class="co">## [13] fastmap_1.2.0       Matrix_1.7-4        jsonlite_2.0.0     </span></span>
<span><span class="co">## [16] mgcv_1.9-3          purrr_1.2.1         scales_1.4.0       </span></span>
<span><span class="co">## [19] gbutils_0.5.1       textshaping_1.0.4   jquerylib_0.1.4    </span></span>
<span><span class="co">## [22] Rdpack_2.6.5        cli_3.6.5           timeSeries_4052.112</span></span>
<span><span class="co">## [25] rlang_1.1.7         rbibutils_2.4.1     splines_4.5.2      </span></span>
<span><span class="co">## [28] cowplot_1.2.0       intervals_0.15.5    withr_3.0.2        </span></span>
<span><span class="co">## [31] cachem_1.1.0        yaml_2.3.12         cvar_0.6           </span></span>
<span><span class="co">## [34] tools_4.5.2         assertthat_0.2.1    vctrs_0.7.1        </span></span>
<span><span class="co">## [37] R6_2.6.1            lifecycle_1.0.5     fs_1.6.6           </span></span>
<span><span class="co">## [40] univariateML_1.5.0  ragg_1.5.0          pkgconfig_2.0.3    </span></span>
<span><span class="co">## [43] desc_1.4.3          pkgdown_2.2.0       pillar_1.11.1      </span></span>
<span><span class="co">## [46] bslib_0.10.0        gtable_0.3.6        glue_1.8.0         </span></span>
<span><span class="co">## [49] systemfonts_1.3.1   xfun_0.56           tidyselect_1.2.1   </span></span>
<span><span class="co">## [52] knitr_1.51          farver_2.1.2        spatial_7.3-18     </span></span>
<span><span class="co">## [55] nlme_3.1-168        htmltools_0.5.9     fBasics_4052.98    </span></span>
<span><span class="co">## [58] labeling_0.4.3      rmarkdown_2.30      timeDate_4052.112  </span></span>
<span><span class="co">## [61] compiler_4.5.2      S7_0.2.1</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan MacLean.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
