% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fits.R
\name{compute_dataset_mnar}
\alias{compute_dataset_mnar}
\title{Compute dataset-level MNAR metric}
\usage{
compute_dataset_mnar(missingness)
}
\arguments{
\item{missingness}{A tibble with columns na_rate and mean_abundance
(as produced by fit_distributions)}
}
\value{
A list with:
\itemize{
\item correlation: Spearman correlation coefficient (negative = MNAR pattern)
\item p_value: p-value for the correlation
\item n_peptides: Number of peptides with missing data used in calculation
\item interpretation: Human-readable interpretation string
}
}
\description{
Calculates Spearman correlation between log(mean_abundance) and NA rate
across peptides to detect whether low-abundance peptides have more missing
values than high-abundance peptides. This is a "between-peptide" MNAR
metric, distinct from the per-peptide "within-peptide" MNAR score.
}
\section{Two Types of MNAR}{

Mass spectrometry data can exhibit two types of MNAR:

\strong{Between-peptide (dataset-level):} Low-abundance peptides are more likely
to have missing values than high-abundance peptides. This is detected by
correlating mean abundance with NA rate across all peptides.

\strong{Within-peptide (per-peptide):} Within a single peptide, the missing
observations tend to be the ones with lower true abundance. This is detected
by the \code{mnar_score} from \code{compute_missingness()}, which compares observed
rank distributions to what would be expected under MCAR.
}

\section{Statistical Power Considerations}{

The per-peptide MNAR score requires sufficient observations (N > 15) for
reliable detection. With typical proteomics sample sizes (N = 3-6), the
per-peptide score has very low power and will often show "0 of N peptides
with MNAR" even when MNAR exists.

The dataset-level metric is more reliable at small sample sizes because it
aggregates information across many peptides.
}

